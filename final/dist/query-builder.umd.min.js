!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t():"function"==typeof define&&define.amd?define(t):t()}(0,function(){"use strict";function e(){}function t(t,n){var r,o,a,i,l=j;for(i=arguments.length;i-- >2;)T.push(arguments[i]);for(n&&null!=n.children&&(T.length||T.push(n.children),delete n.children);T.length;)if((o=T.pop())&&void 0!==o.pop)for(i=o.length;i--;)T.push(o[i]);else"boolean"==typeof o&&(o=null),(a="function"!=typeof t)&&(null==o?o="":"number"==typeof o?o=String(o):"string"!=typeof o&&(a=!1)),a&&r?l[l.length-1]+=o:l===j?l=[o]:l.push(o),r=a;var s=new e;return s.nodeName=t,s.children=l,s.attributes=null==n?void 0:n,s.key=null==n?void 0:n.key,void 0!==P.vnode&&P.vnode(s),s}function n(e,t){for(var n in t)e[n]=t[n];return e}function r(e){!e._dirty&&(e._dirty=!0)&&1==B.push(e)&&(P.debounceRendering||E)(o)}function o(){var e,t=B;for(B=[];e=t.pop();)e._dirty&&k(e)}function a(e,t,n){return"string"==typeof t.nodeName?!e._componentConstructor&&i(e,t.nodeName):n||e._componentConstructor===t.nodeName}function i(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function l(e){var t=n({},e.attributes);t.children=e.children;var r=e.nodeName.defaultProps;if(void 0!==r)for(var o in r)void 0===t[o]&&(t[o]=r[o]);return t}function s(e,t){var n=t?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return n.normalizedNodeName=e,n}function u(e){var t=e.parentNode;t&&t.removeChild(e)}function c(e,t,n,r,o){if("className"===t&&(t="class"),"key"===t);else if("ref"===t)n&&n(null),r&&r(e);else if("class"!==t||o)if("style"===t){if(r&&"string"!=typeof r&&"string"!=typeof n||(e.style.cssText=r||""),r&&"object"==typeof r){if("string"!=typeof n)for(var a in n)a in r||(e.style[a]="");for(var a in r)e.style[a]="number"==typeof r[a]&&!1===U.test(a)?r[a]+"px":r[a]}}else if("dangerouslySetInnerHTML"===t)r&&(e.innerHTML=r.__html||"");else if("o"==t[0]&&"n"==t[1]){var i=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),r?n||e.addEventListener(t,d,i):e.removeEventListener(t,d,i),(e._listeners||(e._listeners={}))[t]=r}else if("list"!==t&&"type"!==t&&!o&&t in e)p(e,t,null==r?"":r),null!=r&&!1!==r||e.removeAttribute(t);else{var l=o&&t!==(t=t.replace(/^xlink\:?/,""));null==r||!1===r?l?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):"function"!=typeof r&&(l?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):e.setAttribute(t,r))}else e.className=r||""}function p(e,t,n){try{e[t]=n}catch(e){}}function d(e){return this._listeners[e.type](P.event&&P.event(e)||e)}function f(){for(var e;e=R.pop();)P.afterMount&&P.afterMount(e),e.componentDidMount&&e.componentDidMount()}function h(e,t,n,r,o,a){M++||(z=null!=o&&void 0!==o.ownerSVGElement,L=null!=e&&!("__preactattr_"in e));var i=m(e,t,n,r,a);return o&&i.parentNode!==o&&o.appendChild(i),--M||(L=!1,a||f()),i}function m(e,t,n,r,o){var a=e,l=z;if(null!=t&&"boolean"!=typeof t||(t=""),"string"==typeof t||"number"==typeof t)return e&&void 0!==e.splitText&&e.parentNode&&(!e._component||o)?e.nodeValue!=t&&(e.nodeValue=t):(a=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(a,e),y(e,!0))),a.__preactattr_=!0,a;var u=t.nodeName;if("function"==typeof u)return w(e,t,n,r);if(z="svg"===u||"foreignObject"!==u&&z,u=String(u),(!e||!i(e,u))&&(a=s(u,z),e)){for(;e.firstChild;)a.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(a,e),y(e,!0)}var c=a.firstChild,p=a.__preactattr_,d=t.children;if(null==p){p=a.__preactattr_={};for(var f=a.attributes,h=f.length;h--;)p[f[h].name]=f[h].value}return!L&&d&&1===d.length&&"string"==typeof d[0]&&null!=c&&void 0!==c.splitText&&null==c.nextSibling?c.nodeValue!=d[0]&&(c.nodeValue=d[0]):(d&&d.length||null!=c)&&v(a,d,n,r,L||null!=p.dangerouslySetInnerHTML),g(a,t.attributes,p),z=l,a}function v(e,t,n,r,o){var i,l,s,c,p,d=e.childNodes,f=[],h={},v=0,b=0,g=d.length,_=0,C=t?t.length:0;if(0!==g)for(w=0;w<g;w++){var N=d[w],x=N.__preactattr_;null!=(k=C&&x?N._component?N._component.__key:x.key:null)?(v++,h[k]=N):(x||(void 0!==N.splitText?!o||N.nodeValue.trim():o))&&(f[_++]=N)}if(0!==C)for(w=0;w<C;w++){p=null;var k=(c=t[w]).key;if(null!=k)v&&void 0!==h[k]&&(p=h[k],h[k]=void 0,v--);else if(!p&&b<_)for(i=b;i<_;i++)if(void 0!==f[i]&&a(l=f[i],c,o)){p=l,f[i]=void 0,i===_-1&&_--,i===b&&b++;break}p=m(p,c,n,r),s=d[w],p&&p!==e&&p!==s&&(null==s?e.appendChild(p):p===s.nextSibling?u(s):e.insertBefore(p,s))}if(v)for(var w in h)void 0!==h[w]&&y(h[w],!1);for(;b<=_;)void 0!==(p=f[_--])&&y(p,!1)}function y(e,t){var n=e._component;n?I(n):(null!=e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),!1!==t&&null!=e.__preactattr_||u(e),b(e))}function b(e){for(e=e.lastChild;e;){var t=e.previousSibling;y(e,!0),e=t}}function g(e,t,n){var r;for(r in n)t&&null!=t[r]||null==n[r]||c(e,r,n[r],n[r]=void 0,z);for(r in t)"children"===r||"innerHTML"===r||r in n&&t[r]===("value"===r||"checked"===r?e[r]:n[r])||c(e,r,n[r],n[r]=t[r],z)}function _(e){var t=e.constructor.name;(D[t]||(D[t]=[])).push(e)}function C(e,t,n){var r,o=D[e.name];if(e.prototype&&e.prototype.render?(r=new e(t,n),S.call(r,t,n)):((r=new S(t,n)).constructor=e,r.render=N),o)for(var a=o.length;a--;)if(o[a].constructor===e){r.nextBase=o[a].nextBase,o.splice(a,1);break}return r}function N(e,t,n){return this.constructor(e,n)}function x(e,t,n,o,a){e._disable=!0,(e.__ref=t.ref)&&delete t.ref,(e.__key=t.key)&&delete t.key,!e.base||a?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,o),o&&o!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=o),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,0!==n&&(1!==n&&!1===P.syncComponentUpdates&&e.base?r(e):k(e,1,a)),e.__ref&&e.__ref(e)}function k(e,t,r,o){var a,i,s,u=e.props,c=e.state,p=e.context,d=e.prevProps||u,m=e.prevState||c,v=e.prevContext||p,b=e.base,g=e.nextBase,_=b||g,N=e._component,w=!1;if(b&&(e.props=d,e.state=m,e.context=v,2!==t&&e.shouldComponentUpdate&&!1===e.shouldComponentUpdate(u,c,p)?w=!0:e.componentWillUpdate&&e.componentWillUpdate(u,c,p),e.props=u,e.state=c,e.context=p),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!w){a=e.render(u,c,p),e.getChildContext&&(p=n(n({},p),e.getChildContext()));var S,O,A=a&&a.nodeName;if("function"==typeof A){var q=l(a);(i=N)&&i.constructor===A&&q.key==i.__key?x(i,q,1,p,!1):(S=i,e._component=i=C(A,q,p),i.nextBase=i.nextBase||g,i._parentComponent=e,x(i,q,0,p,!1),k(i,1,r,!0)),O=i.base}else s=_,(S=N)&&(s=e._component=null),(_||1===t)&&(s&&(s._component=null),O=h(s,a,p,r||!b,_&&_.parentNode,!0));if(_&&O!==_&&i!==N){var T=_.parentNode;T&&O!==T&&(T.replaceChild(O,_),S||(_._component=null,y(_,!1)))}if(S&&I(S),e.base=O,O&&!o){for(var j=e,E=e;E=E._parentComponent;)(j=E).base=O;O._component=j,O._componentConstructor=j.constructor}}if(!b||r?R.unshift(e):w||(e.componentDidUpdate&&e.componentDidUpdate(d,m,v),P.afterUpdate&&P.afterUpdate(e)),null!=e._renderCallbacks)for(;e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);M||o||f()}function w(e,t,n,r){for(var o=e&&e._component,a=o,i=e,s=o&&e._componentConstructor===t.nodeName,u=s,c=l(t);o&&!u&&(o=o._parentComponent);)u=o.constructor===t.nodeName;return o&&u&&(!r||o._component)?(x(o,c,3,n,r),e=o.base):(a&&!s&&(I(a),e=i=null),o=C(t.nodeName,c,n),e&&!o.nextBase&&(o.nextBase=e,i=null),x(o,c,1,n,r),e=o.base,i&&e!==i&&(i._component=null,y(i,!1))),e}function I(e){P.beforeUnmount&&P.beforeUnmount(e);var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?I(n):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),e.nextBase=t,u(t),_(e),b(t)),e.__ref&&e.__ref(null)}function S(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{}}function O(e){return t("div",{className:"queries"},e.queries.map(function(n){return t("span",{className:"query",key:n.id},n.combinator?n.combinator+" ":"",n.attribute," ",t("span",{className:"query-operator"},n.operator)," ",n.input,t("a",{className:"query-remove",href:"",onClick:function(t){return e.onClick(t,n.id)}},"x"))}))}function A(e){var n=void 0;return e.selectedAttribute&&(n=function(n){switch(n){case"STRING":return t("input",{className:"filter-input",name:"selectedInput",onInput:e.handleInputChange});case"NUMBER":return t("input",{className:"filter-input",name:"selectedInput",type:"number",onInput:e.handleInputChange});case"DATE":return t("input",{className:"filter-input",name:"selectedInput",type:"date",onChange:e.handleInputChange});case"BOOLEAN":return t("select",{className:"filter-dropdown",name:"selectedInput",onChange:e.handleInputChange},t("option",{value:""}),t("option",{value:e.copy.filter.boolean.true.id},e.copy.filter.boolean.true.label),t("option",{value:e.copy.filter.boolean.false.id},e.copy.filter.boolean.false.label));case"ENUM":var r=e.enum.map(function(e){return t("option",{key:e,value:e},e)});return t("select",{className:"filter-dropdown",onChange:e.handleInputChange,multiple:!0,size:"1"},r);default:return null}}(e.selectedAttribute.split("_")[1])),t("div",null,n)}function q(e){return t("div",{className:"panel"},t("h2",{className:"panel-heading"},e.copy.panel.heading),t(J,{entities:e.entities,attributes:e.attributes,operators:e.operators,enum:e.enum,combinators:e.combinators,copy:e.copy}))}var P={},T=[],j=[],E="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout,U=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,B=[],R=[],M=0,z=!1,L=!1,D={};n(S.prototype,{setState:function(e,t){var o=this.state;this.prevState||(this.prevState=n({},o)),n(o,"function"==typeof e?e(o,this.props):e),t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),r(this)},forceUpdate:function(e){e&&(this._renderCallbacks=this._renderCallbacks||[]).push(e),k(this,2)},render:function(){}});var Q={ENDPOINT:"/data.json"},W=(function(){function e(e){this.value=e}function t(t){function n(o,a){try{var i=t[o](a),l=i.value;l instanceof e?Promise.resolve(l.value).then(function(e){n("next",e)},function(e){n("throw",e)}):r(i.done?"return":"normal",i.value)}catch(e){r("throw",e)}}function r(e,t){switch(e){case"return":o.resolve({value:t,done:!0});break;case"throw":o.reject(t);break;default:o.resolve({value:t,done:!1})}(o=o.next)?n(o.key,o.arg):a=null}var o,a;this._invoke=function(e,t){return new Promise(function(r,i){var l={key:e,arg:t,resolve:r,reject:i,next:null};a?a=a.next=l:(o=a=l,n(e,t))})},"function"!=typeof t.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)}}(),function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}),V=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),H=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},G=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},$=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},F=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},J=function(e){function n(e){W(this,n);var t=$(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.state={selectedOrganization:t.props.entities[0].id,selectedAttribute:"",selectedOperator:"",selectedInput:"",selectedCombinator:t.props.combinators[0],queries:[],attributes:t.props.attributes.reduce(function(e,t){var n=Object.keys(t)[0];return e[n]=t[n],e},{}),operators:Object.keys(t.props.operators).map(function(e){return{id:e,label:t.props.operators[e]}})},t.handleInputChange=t.handleInputChange.bind(t),t.handleAddQuery=t.handleAddQuery.bind(t),t.handleRemoveQuery=t.handleRemoveQuery.bind(t),t.handleReset=t.handleReset.bind(t),t}return G(n,S),V(n,[{key:"handleInputChange",value:function(e){var t=e.target.name;this.setState(H({},t,e.target.value))}},{key:"handleAddQuery",value:function(e){var t=[].concat(F(this.state.queries)),n={id:this.state.queries.length,attribute:this.state.selectedAttribute,operator:this.state.selectedOperator,input:this.state.selectedInput};t.length>0&&(n.combinator=this.state.selectedCombinator),t.push(n),this.setState({queries:t}),this.handleReset(e)}},{key:"handleRemoveQuery",value:function(e,t){e.preventDefault();var n=this.state.queries.filter(function(e){return e.id!==t});this.setState({queries:n})}},{key:"handleReset",value:function(e){e.preventDefault(),this.setState({selectedAttribute:"",selectedOperator:"",selectedInput:""})}},{key:"render",value:function(){var e=this.props.entities.map(function(e){return t("option",{key:e.id,value:e.id},e.label)}),n=this.state.attributes[this.state.selectedOrganization].map(function(e){return t("option",{key:e,value:e},e)}),r=this.state.operators.map(function(e){return t("option",{key:e.id,value:e.id},e.label)}),o=this.props.combinators.map(function(e){return t("option",{key:e,value:e},e)}),a=this.state.selectedOrganization&&this.state.selectedAttribute&&this.state.selectedOperator&&this.state.selectedInput;return t("form",{className:"filter-form"},t("div",{className:"primary-content"},t("select",{className:"filter-dropdown",name:"selectedOrganization",value:this.state.selectedOrganization,onChange:this.handleInputChange},e),t(O,{queries:this.state.queries,onClick:this.handleRemoveQuery})),t("div",{className:"secondary-content"},this.state.queries.length>0&&t("select",{className:"filter-dropdown",name:"selectedCombinator",value:this.state.selectedCombinator,onChange:this.handleInputChange},o),t("select",{className:"filter-dropdown",name:"selectedAttribute",value:this.state.selectedAttribute,onChange:this.handleInputChange},t("option",{value:"",disabled:!0,hidden:!0},this.props.copy.filter.attributePlaceholder),n),this.state.selectedAttribute&&t("select",{className:"filter-dropdown",name:"selectedOperator",value:this.state.selectedOperator,onChange:this.handleInputChange},t("option",{value:"",disabled:!0,hidden:!0},this.props.copy.filter.operatorPlaceholder),r),t(A,{selectedAttribute:this.state.selectedAttribute,copy:this.props.copy,handleInputChange:this.handleInputChange}),t("div",{className:"filter-icons"},a&&t("a",{className:"filter-plus",href:"",onClick:this.handleAddQuery},"+"),this.state.selectedAttribute&&t("a",{className:"filter-minus",href:"",onClick:this.handleReset},"-"))))}}]),n}();!function(e,t){if("undefined"==typeof document)return t;e=e||"";var n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",n.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}("*{box-sizing:border-box}html{font-size:calc(10px + 14 * (100vw - 320px) / 1600)}body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;margin:0;padding:2rem 3rem}.query-builder{margin:0 auto;max-width:1024px}.panel{border:2px solid #000}.panel-heading{background:#000;color:#fff;font-size:1rem;font-weight:400;margin:0;padding:.3em .5em .4em}.filter-form{padding:.8rem}.primary-content{display:flex}.secondary-content{align-items:center;display:flex;margin-top:.8rem}.filter-dropdown,.filter-input{border:1px solid #a9a9a9;border-radius:.2rem;display:flex;margin-right:.8rem;padding:.2rem}.filter-icons{display:flex}.filter-minus,.filter-plus,.query-remove{align-items:center;color:#fff;display:flex;font-family:monospace;font-size:1.2rem;height:1.3rem;justify-content:center;text-decoration:none;width:1.3rem}.filter-plus{background:#4caf50;margin-right:.8rem}.filter-minus{background:red}.query-remove{color:#000;display:inline;margin-left:.8rem;font-weight:700}.queries{display:flex}.queries span:last-child{border-right:0}.query{border-right:1px solid #a9a9a9;padding:0 .8rem}.query-operator{color:#2196f3}",void 0),function(e,t,n){h(n,e,{},!1,t,!1)}(t(function(e){function n(){W(this,n);var e=$(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.state={data:null},e}return G(n,S),V(n,[{key:"componentDidMount",value:function(){var e=this;fetch(Q.ENDPOINT).then(function(e){return e.json()}).then(function(t){return e.setState({data:t})})}},{key:"render",value:function(){var e=this.state.data?t(q,{entities:this.state.data.entity,attributes:this.state.data.attribute,operators:this.state.data.operator,enum:this.state.data.enum,combinators:this.state.data.combinator,copy:this.state.data.copy}):null;return t("main",{className:"query-builder"},t("h1",null,"Query Builder"),e)}}]),n}(),null),document.getElementById("app"))});
